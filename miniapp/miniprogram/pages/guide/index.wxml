<view class="page">
  <!-- 头部 -->
  <view class="page-header">
    <view class="brand">
      <view class="logo-box">
        <view class="logo-icon icon-paper-plane"></view>
      </view>
      <text class="brand-text">Travel Planner</text>
    </view>
    
    <!-- 顶部标签栏 -->
    <view class="top-tabs">
      <view class="tab-item" bindtap="goInput">
        <view class="tab-icon icon-compass"></view>
        <text class="tab-text">输入</text>
      </view>
      <view class="tab-item" bindtap="goRoute">
        <view class="tab-icon icon-route"></view>
        <text class="tab-text">路线</text>
      </view>
      <view class="tab-item active">
        <view class="tab-icon icon-book"></view>
        <text class="tab-text">攻略</text>
      </view>
    </view>
  </view>

  <view class="module">
    <scroll-view scroll-y class="module-scroll">
      <!-- Guide Form Card -->
      <view class="card">
        <view class="card-title has-icon">
          <view class="title-icon icon-form"></view>
          <text>填写需求</text>
        </view>
        <text class="hint" style="margin-bottom: 24rpx; display: block;">已带入：{{guideContextSummary}}</text>

        <view class="input-group">
          <!-- Removed Icon -->
          <text class="input-label">出行天数</text>
          <view class="input-box">
            <input class="input" placeholder="例如：3天2晚" data-field="days" bindinput="onGuideInput" value="{{guideParams.days}}" />
          </view>
        </view>

        <view class="input-group">
          <!-- Removed Icon -->
          <text class="input-label">预算</text>
          <view class="input-box">
            <input class="input" placeholder="例如：¥3000/人" data-field="budget" bindinput="onGuideInput" value="{{guideParams.budget}}" />
          </view>
        </view>

        <view class="input-group">
          <!-- Removed Icon -->
          <text class="input-label">偏好</text>
          <view class="input-box">
            <input class="input" placeholder="如：美食 / 拍照 / 亲子" data-field="vibe" bindinput="onGuideInput" value="{{guideParams.vibe}}" />
          </view>
        </view>

        <view class="input-group">
          <!-- Removed Icon -->
          <text class="input-label">节奏</text>
          <view class="chip-row">
            <view class="chip {{guideParams.pace === '慢' ? 'active' : ''}}" bindtap="setGuidePace" data-val="慢">慢</view>
            <view class="chip {{guideParams.pace === '正常' ? 'active' : ''}}" bindtap="setGuidePace" data-val="正常">正常</view>
            <view class="chip {{guideParams.pace === '紧凑' ? 'active' : ''}}" bindtap="setGuidePace" data-val="紧凑">紧凑</view>
          </view>
        </view>

        <view class="input-group">
          <text class="input-label">其他要求</text>
          <view class="input-box">
            <input class="input" placeholder="如：避开人多景点、含亲子活动" data-field="other" bindinput="onGuideInput" value="{{guideParams.other}}" />
          </view>
        </view>

        <button class="btn-accent" bindtap="onGenerateGuide" loading="{{guideLoading}}" style="margin-top: 32rpx;">
          {{guideLoading ? '生成中…' : '生成攻略'}}
        </button>
      </view>

      <!-- Result Card -->
      <view class="card" wx:if="{{guideResult}}">
        <view class="card-title has-icon">
          <view class="title-icon icon-sparkles"></view>
          <text>攻略展示</text>
        </view>
        
        <view class="input-group">
          <text class="card-subtitle">{{guideResult.title}}</text>
          <text class="result-text">{{guideResult.summary}}</text>
        </view>
        
        <!-- 行程 -->
        <view class="input-group">
          <text class="card-subtitle">行程建议</text>
          <view class="result-list">
            <block wx:if="{{guideResult.itinerary.length > 0}}">
              <block wx:for="{{guideResult.itinerary}}" wx:key="index">
                <view class="result-item">{{item}}</view>
              </block>
            </block>
            <text wx:else class="result-text">暂无</text>
          </view>
        </view>
        
        <!-- 清单 -->
        <view class="input-group">
          <text class="card-subtitle">必做清单</text>
          <view class="result-list">
            <block wx:if="{{guideResult.mustDo.length > 0}}">
              <block wx:for="{{guideResult.mustDo}}" wx:key="index">
                <view class="result-item">{{item}}</view>
              </block>
            </block>
            <text wx:else class="result-text">暂无</text>
          </view>
        </view>

        <view class="input-group" wx:if="{{guideResult.tips.length > 0}}">
          <text class="card-subtitle">实用提示</text>
          <view class="result-list">
            <block wx:for="{{guideResult.tips}}" wx:key="index">
              <view class="result-item">{{item}}</view>
            </block>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</view>
